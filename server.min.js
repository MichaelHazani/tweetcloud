"use strict";var express=require("express"),twitter=require("node-twitter"),keys=require("./secrets.js"),app=express(),compress=require("compression"),http=require("http"),server=http.createServer(app),io=require("socket.io").listen(server),tweets=[],tweeting=!1,bodyparser=require("body-parser"),tweetList;app.use(compress()),app.use(bodyparser.json()),app.use(bodyparser.urlencoded({extended:!0})),app.use(express["static"]("app")),server.listen(process.env.PORT||3e3);var twitterStreamClient=new twitter.StreamClient(keys.consumerKey,keys.consumerSecret,keys.token,keys.tokenSecret);twitterStreamClient.on("close",function(){console.log("Connection closed.")}),twitterStreamClient.on("end",function(){console.log("End of Line.")}),twitterStreamClient.on("error",function(e){console.log("Error: "+(e.code?e.code+" "+e.message:e.message))}),app.get("/",function(e,t){t.sendFile("index.html")}),io.sockets.on("connection",function(e){e.on("start tweets",function(e){twitterStreamClient.start([e])}),e.on("stop",function(){twitterStreamClient.stop(),tweets=[],e.disconnect()}),e.on("disconnect",function(){twitterStreamClient.stop(),tweets=[],e.disconnect()}),twitterStreamClient.on("tweet",function(t){tweets.push(t.text),e.emit("twitter-stream",tweets),tweets=[]})});